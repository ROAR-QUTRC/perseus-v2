<?xml version="1.0"?>
<robot name="motor_wheel" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <xacro:include filename="$(find perseus_lite_description)/urdf/wheel.urdf.xacro"/>

  <!-- MOTOR JOINT -->
  <xacro:macro name="motor_wheel" params="prefix:=^ side:=^ end *origin">
    <link name="${prefix}${end}_${side}_motor">
      <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
        <mass value="2.6182895"/>
        <inertia ixx="0.00125" iyy="0.00125" izz="0.00125" ixy="0.0" iyz="0.0" ixz="0.0"/>
      </inertial>

      <visual>
        <xacro:if value="${side == 'left'}">
          <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 ${-pi/2}"/>
        </xacro:if>
        <xacro:if value="${side == 'right'}">
          <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 ${pi/2}"/>
        </xacro:if>
        <geometry>
          <mesh scale="0.05 0.05 0.05" filename="file://$(find perseus_description)/meshes/gearbox.dae"/>
        </geometry>
      </visual>

      <collision>
        <xacro:if value="${side == 'left'}">
          <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 ${pi/2}"/>
        </xacro:if>
        <xacro:if value="${side == 'right'}">
          <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 ${-pi/2}"/>
        </xacro:if>
        <geometry>
          <box size="0.05 0.05 0.0375" />
        </geometry>
      </collision>
    </link>

    <!-- JOINT -->
    <joint name="${prefix}${end}_${side}_motor_joint" type="fixed">
      <parent link="${prefix}${side}_rocker"/>
      <child link="${prefix}${end}_${side}_motor"/>
      <xacro:insert_block name="origin"/>
    </joint>

    <!-- TRANSMISSION -->
    <!-- <transmission name="gear_ratio">
      <type>transmission_interface/SimpleTransmission</type>
      <joint name="bogie_${prefix}_to_motor_${prefix}_${suffix}">
        <hardwareInterface>EffortJointInterface</hardwareInterface>
      </joint>
      <actuator name="">
        <mechanicalReduction>30</mechanicalReduction>
        <hardwareInterface>EffortJointInterface</hardwareInterface>
      </actuator>
    </transmission> -->

    <xacro:wheel />
  </xacro:macro>
</robot>